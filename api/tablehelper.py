from sqlalchemy import engine
from sqlalchemy.sql.expression import insert, select
import tables as tables
from database import engine


def fill_up_base():
    #TODO add 8-10 cameras and rename prob
    stmt = (
        insert(tables.Cameras).
        values([{"camera_name": "camera1",
                 "stream_url": "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1627258800/ei/UKv9YMaoLNK07gPnhIm4CQ/ip/109.86.185.70/id/73gIDMkV7_s.23/itag/95/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D136/hls_chunk_host/r2---sn-ugpva5o-ig3s.googlevideo.com/playlist_duration/30/manifest_duration/30/vprv/1/playlist_type/DVR/initcwndbps/10180/mh/T9/mm/44/mn/sn-ugpva5o-ig3s/ms/lva/mv/m/mvi/2/pl/24/dover/11/keepalive/yes/fexp/24001373,24007246/beids/23886205/mt/1627236997/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,playlist_duration,manifest_duration,vprv,playlist_type/sig/AOq0QJ8wRQIhAKrOtfay3bANYOvlU6B7mAn81zxnG0g85HSLW7RCZXB6AiAwm_VLj4XV84GsKO4deNhuJaawds4w37VVUyq8VcHAag%3D%3D/lsparams/hls_chunk_host,initcwndbps,mh,mm,mn,ms,mv,mvi,pl/lsig/AG3C_xAwRQIgZFlTkd8PYol87NCzhgWkRgKdsU9ed_UfS3P92U5LZO0CIQDO8onWxeHJhov9NRzCrVQ9VZtvObxNSjrpTRuecfTk8g%3D%3D/playlist/index.m3u8",
                 "is_active": True},
                {"camera_name": "camera2",
                 "stream_url": "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1627258802/ei/Uqv9YNDxHbaEx_AP1-SDyA0/ip/109.86.185.70/id/Dsf2OfaqRL8.1/itag/96/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D137/hls_chunk_host/r1---sn-ugpva5o-ig3s.googlevideo.com/playlist_duration/30/manifest_duration/30/vprv/1/playlist_type/DVR/mh/OZ/mm/44/mn/sn-ugpva5o-ig3s/ms/lva/mv/u/mvi/1/pl/24/dover/11/keepalive/yes/fexp/24001373,24007246/beids/23886205/mt/1627236494/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,playlist_duration,manifest_duration,vprv,playlist_type/sig/AOq0QJ8wRAIgfOfQFMA8PhUO1YxsYuEZsT87AhHWoLsKHsxOezl0sj0CIBP7dY-A9dzqsgHnua4jTq8Yk16edtJJPGukFiEbmQUC/lsparams/hls_chunk_host,mh,mm,mn,ms,mv,mvi,pl/lsig/AG3C_xAwRQIgWLVBRaP32gs_DCCun6shZd1bFEYUhS4JreuknyPmJUECIQCstEZB_brqF39-CD7-s8aekpg9yz0LHwdiAsSVC87b9A%3D%3D/playlist/index.m3u8",
                 "is_active": True},
                {"camera_name": "camera3",
                 "stream_url": "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1627258804/ei/VKv9YOjGApfqgAfL4r-ICw/ip/109.86.185.70/id/_BENPw-ZkRc.2/itag/96/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D137/hls_chunk_host/r3---sn-ugpva5o-ig3s.googlevideo.com/playlist_duration/30/manifest_duration/30/vprv/1/playlist_type/DVR/mh/6I/mm/44/mn/sn-ugpva5o-ig3s/ms/lva/mv/u/mvi/3/pl/24/dover/11/keepalive/yes/fexp/24001373,24007246/beids/23886205/mt/1627236494/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,playlist_duration,manifest_duration,vprv,playlist_type/sig/AOq0QJ8wRAIgBsGV_vlhzJ6I1IpcMVJaF076MjnMHQR-A0EDTpdI-rsCIBnX1hhgrK198DbPCknwGhLiewcL2pPO5bRRvVB4mWae/lsparams/hls_chunk_host,mh,mm,mn,ms,mv,mvi,pl/lsig/AG3C_xAwRgIhAPIuMSAtiAHeCjXx62cCdSnYoOtivBziGZUGeHmLtXibAiEA8DtxIZR3i_nRiyk9UZ0oZIdWf_ggfPctVK-X2u2O-cU%3D/playlist/index.m3u8",
                 "is_active": True},
                {"camera_name": "camera4",
                 "stream_url": "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1627258806/ei/Vav9YJLiOcXl7gPtnIPoAQ/ip/109.86.185.70/id/5hHelJALhEo.4/itag/96/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D137/hls_chunk_host/r4---sn-ugpva5o-ig3s.googlevideo.com/playlist_duration/30/manifest_duration/30/vprv/1/playlist_type/DVR/mh/e1/mm/44/mn/sn-ugpva5o-ig3s/ms/lva/mv/u/mvi/4/pl/24/dover/11/keepalive/yes/fexp/24001373,24007246/beids/23886205/mt/1627236494/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,playlist_duration,manifest_duration,vprv,playlist_type/sig/AOq0QJ8wRAIgcTVEFCDvXjsYbvge1L8KYrrMkEObt6GcXPFGtFtbl-8CIFcJg-PrNIyujvLb5lFCP4rBT-4Z3x-9By9_CyCURHi5/lsparams/hls_chunk_host,mh,mm,mn,ms,mv,mvi,pl/lsig/AG3C_xAwRQIgTBJJxWIDOi--l5jJyrp700Eq5F4k0Xw7xa-w3vyEr8gCIQC6FW3NgIOOnCE62XuwjTurui_Un64jpKCvd-iaJg2o6g%3D%3D/playlist/index.m3u8",
                 "is_active": True},
                {"camera_name": "camera5",
                 "stream_url": "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1627258807/ei/V6v9YP6OK8Xk-gbW7Im4CA/ip/109.86.185.70/id/4qyZLflp-sI.3/itag/96/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D137/hls_chunk_host/r4---sn-ugpva5o-ig3s.googlevideo.com/playlist_duration/30/manifest_duration/30/vprv/1/playlist_type/DVR/initcwndbps/10180/mh/OR/mm/44/mn/sn-ugpva5o-ig3s/ms/lva/mv/m/mvi/4/pl/24/dover/11/keepalive/yes/fexp/24001373,24007246/beids/23886205/mt/1627236997/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,playlist_duration,manifest_duration,vprv,playlist_type/sig/AOq0QJ8wRQIhAMA33_UKMpPI-_Ys9dpuihGTSKhTTTww_Qxy6CpVGSXYAiAkDgEpAaCx2FIBUjk01a1kOE-gUdAlmwVkg5ZQ9JjMjw%3D%3D/lsparams/hls_chunk_host,initcwndbps,mh,mm,mn,ms,mv,mvi,pl/lsig/AG3C_xAwRgIhAJwDft88yOEUeFkSG_bQllL9Fep3xzvg766vlPuPFCzEAiEAvmf7Pq3urV4T1XO0dZnu5Jgp-xnqodCbXWLcIoDeszA%3D/playlist/index.m3u8",
                 "is_active": True},
                {"camera_name": "camera6",
                 "stream_url": "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1627258809/ei/Wav9YM6BE5Cl-gbbsKb4AQ/ip/109.86.185.70/id/OcrV35VFsok.3/itag/96/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D137/hls_chunk_host/r3---sn-ugpva5o-ig3s.googlevideo.com/playlist_duration/30/manifest_duration/30/vprv/1/playlist_type/DVR/initcwndbps/10180/mh/H9/mm/44/mn/sn-ugpva5o-ig3s/ms/lva/mv/m/mvi/3/pl/24/dover/11/keepalive/yes/fexp/24001373,24007246/beids/23886205/mt/1627236997/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,playlist_duration,manifest_duration,vprv,playlist_type/sig/AOq0QJ8wRAIgX7mO0p0Lv-cJIwMtH-XCGjbuIytFrmgb_K6k3RQSolYCIFdW4OQvOE-OUGCyeJ3kjAcYvi5UeBmJcaC1hCaLCGpO/lsparams/hls_chunk_host,initcwndbps,mh,mm,mn,ms,mv,mvi,pl/lsig/AG3C_xAwRQIgC4z6QNn03f4O6aaNPIlTS4agquq1YrcVJSpNvutAypcCIQDS3aPMIVKBXAlPm5tvtBvdeFtP_NLHcr_wy_H2Np6eVQ%3D%3D/playlist/index.m3u8",
                 "is_active": True},
                {"camera_name": "camera7",
                 "stream_url": "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1627258811/ei/W6v9YOqFEdPt-gaEroW4Bw/ip/109.86.185.70/id/oSoR2qsv7es.5/itag/96/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D137/hls_chunk_host/r3---sn-ugpva5o-ig3s.googlevideo.com/playlist_duration/30/manifest_duration/30/vprv/1/playlist_type/DVR/initcwndbps/10180/mh/w0/mm/44/mn/sn-ugpva5o-ig3s/ms/lva/mv/m/mvi/3/pcm2cms/yes/pl/24/dover/11/keepalive/yes/fexp/24001373,24007246/beids/23886205/mt/1627236997/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,playlist_duration,manifest_duration,vprv,playlist_type/sig/AOq0QJ8wRAIgXkJtxHyy-n2erEVw9OolJGPeE46PCf6aEBQ4oyQ7qaACIFLmHA0Fd8LsMq12TbhYT1t19cS_PA-34MiXn5Byf51C/lsparams/hls_chunk_host,initcwndbps,mh,mm,mn,ms,mv,mvi,pcm2cms,pl/lsig/AG3C_xAwRQIhAJU2XqImNKouCcKP4OFYq2-FUQoUmA_xQP5Vb3P9drqjAiAZ0FwlGrLWImC7cln-AFP_HeQIyXUJ1hU2YA343QTQng%3D%3D/playlist/index.m3u8",
                 "is_active": True},
                {"camera_name": "camera8",
                 "stream_url": "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1627258812/ei/XKv9YK7BJ4bogAel66iwBg/ip/109.86.185.70/id/fYoP5VLgetY.1/itag/96/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D137/hls_chunk_host/r4---sn-ugpva5o-ig3s.googlevideo.com/playlist_duration/30/manifest_duration/30/vprv/1/playlist_type/DVR/initcwndbps/10180/mh/C0/mm/44/mn/sn-ugpva5o-ig3s/ms/lva/mv/m/mvi/4/pl/24/dover/11/keepalive/yes/fexp/24001373,24007246/beids/23886205/mt/1627236997/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,playlist_duration,manifest_duration,vprv,playlist_type/sig/AOq0QJ8wRQIhAKlaQazjs_Wy6Qi18-XP00Fs1T6kWttGhDectQvKSzn-AiB_bFiapEJOdJDnhMegGdsbBzt1gM5Jm5pa2sHKgHVh_g%3D%3D/lsparams/hls_chunk_host,initcwndbps,mh,mm,mn,ms,mv,mvi,pl/lsig/AG3C_xAwRQIgQJt76t4k3YO_vUDOJSdLho-uxhdD_FX8IbTlKSpOmYMCIQCvN66zD6gSnPhJfcbPNua7HNlapmGcewLmH4AcaVSiKw%3D%3D/playlist/index.m3u8",
                 "is_active": True},
                {"camera_name": "camera9",
                 "stream_url": "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1627258814/ei/Xqv9YN6pDdD4gAedzIPoAg/ip/109.86.185.70/id/PWKjaA-wNho.2/itag/96/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D137/hls_chunk_host/r3---sn-ugpva5o-ig3s.googlevideo.com/playlist_duration/30/manifest_duration/30/vprv/1/playlist_type/DVR/initcwndbps/10180/mh/jA/mm/44/mn/sn-ugpva5o-ig3s/ms/lva/mv/m/mvi/3/pl/24/dover/11/keepalive/yes/fexp/24001373,24007246/beids/23886205/mt/1627236997/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,playlist_duration,manifest_duration,vprv,playlist_type/sig/AOq0QJ8wRAIgCIsHImXpeDj_jvs8SLZDynJFmebwAaXv7DZiPPkPBcICIErhMyJDnF6CQiOWsHgw4KDEV5zlNi56wjtBNaBoqc9N/lsparams/hls_chunk_host,initcwndbps,mh,mm,mn,ms,mv,mvi,pl/lsig/AG3C_xAwRQIgXO8Dzt5BsRnPInyj7wWwxvEo0CQc1dd3Imw4CVp3ekoCIQC8KAGvbVdVaknl2WJMhtbgFBcEERqkwJZaUBfXrKlOKw%3D%3D/playlist/index.m3u8",
                 "is_active": True},
                {"camera_name": "camera10",
                 "stream_url": "https://manifest.googlevideo.com/api/manifest/hls_playlist/expire/1627258815/ei/X6v9YP23M8XX7gO905CIBw/ip/109.86.185.70/id/xWAaC3MuaZQ.3/itag/96/source/yt_live_broadcast/requiressl/yes/ratebypass/yes/live/1/sgoap/gir%3Dyes%3Bitag%3D140/sgovp/gir%3Dyes%3Bitag%3D137/hls_chunk_host/r1---sn-ugpva5o-ig3s.googlevideo.com/playlist_duration/30/manifest_duration/30/vprv/1/playlist_type/DVR/initcwndbps/10180/mh/YI/mm/44/mn/sn-ugpva5o-ig3s/ms/lva/mv/m/mvi/1/pl/24/dover/11/keepalive/yes/fexp/24001373,24007246/beids/23886205/mt/1627236997/sparams/expire,ei,ip,id,itag,source,requiressl,ratebypass,live,sgoap,sgovp,playlist_duration,manifest_duration,vprv,playlist_type/sig/AOq0QJ8wRAIgEh-u8TqZ3Fzr5jSRAtZrxphpZFPb-EueAj999d8ezY0CIAo52yrkLCbozQb-A8EftPG2W46FJMbZzM2PQcDSvAfy/lsparams/hls_chunk_host,initcwndbps,mh,mm,mn,ms,mv,mvi,pl/lsig/AG3C_xAwRQIhALdpKe7Dby7Ll4ZR35o4HJgJFuuXxPxrCVHP81c_W6XMAiBJIna66X-0tdbfvW7_EFqliSllcwMAxn75YnSWFygPSw%3D%3D/playlist/index.m3u8",
                 "is_active": True}])
    )

    conn = engine.connect()
    conn.execute(stmt)
    conn.close()


def tables_exist() -> bool:
    conn = engine.connect()
    try:
        stmt = select(tables.Cameras)
        conn.execute(stmt)
        return True
    except:
        return False
    
        